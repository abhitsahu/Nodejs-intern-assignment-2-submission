<html lang="pt">

<head>
    <meta charset="UTF-8"/>
    <title>My Fin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- Compiled and minified CSS -->
    <!-- <link rel="stylesheet" href="./css/materialize.min.css" /> -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="./js/external/css-loader/dist/css-loader.css">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.2.2/dist/css/materialize.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="./js/external/monthpicker/monthpicker.css">
    <link href="https://unpkg.com/tabulator-tables@4.5.3/dist/css/tabulator.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" rel="stylesheet"/>


    <!-- <link href="./js/external/Select2/select2.css" rel="stylesheet" />
    <link href="./css/select2-materialize.css" type="text/css" rel="stylesheet" />
    <link href="./js/external/jquery-datepicker/jquery-datepicker.css" rel="stylesheet">
    <link href="./js/external/fullcalendar/fullcalendar.min.css" rel="stylesheet">
    <link href="./js/external/monthpicker/monthpicker.css" rel="stylesheet"> -->
    <!-- <link href="./js/external/fullcalendar/materialDesign.css" rel="stylesheet"> -->
    <!-- <link href="./js/external/fullcalendar/fullcalendar.print.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="./css/main.css"/>
    <link rel="stylesheet" href="./css/dashboard.css"/>
    <link rel="stylesheet" href="./css/budgets.css"/>
    <link rel="stylesheet" href="./css/invest.css"/>
    <link rel="stylesheet" href="./css/progressbar.css"/>
    <link rel="stylesheet" href="./css/themes/dark_gray_theme.css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">

    <!-- Localization -->
    <script src="https://cdn.jsdelivr.net/npm/i18next@21.6.10/i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-i18next@1.2.1/jquery-i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@6.1.3/i18nextBrowserLanguageDetector.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-http-backend@1.3.2/i18nextHttpBackend.min.js"></script>
    <script src="js/utils/localization.js" type="module"></script>


    <!--<link rel="stylesheet" href="./css/themes/light_theme.css"/>-->
</head>

<body class="fill-height">
<header>
    <nav class="top-nav">
        <div class="nav-wrapper row">
            <!--<div class="col s2 card-panel">
                <input id="dashboard-monthpicker" type="text" placeholder="Escolha um mês"/>
            </div>-->
            <div class="col s6">
                <div class="row top-summary-wrapper">
                    <div class="col top-summary-col"><span class="top-summary-label"><span data-i18n="topBar.operatingFunds"></span></span><br><span
                            class="top-summary-key" id="top-summary-col-current-savings-value">0€</span></div>
                    <div class="col top-summary-col"><span class="top-summary-label"><span data-i18n="topBar.investing"></span></span><br><span
                            class="top-summary-key" id="top-summary-col-investments-value">0€</span></div>
                    <div class="col top-summary-col"><span class="top-summary-label"><span data-i18n="topBar.debt"></span></span><br><span
                            class="top-summary-key" id="top-summary-col-credits-value">0€</span></div>
                    <div class="col top-summary-col"><span class="top-summary-label"><span data-i18n="topBar.netWorth"></span></span><br><span
                            class="top-summary-key" id="top-summary-col-patrimony-value">0€</span></div>
                </div>
            </div>
            <div class="col s6">
                <ul class="right hide-on-small-only">
                    <li><a href="#!profile"
                           onClick="configs.goToPage('profile');MenuUtils.changeActiveMenu('profile')"><i
                            class="large material-icons">account_circle</i></a>
                    </li>
                    <li><a id="logout-btn" href="#"><i
                            class="large material-icons">exit_to_app</i></a></li>
                </ul>
            </div>

        </div>
    </nav>
    <nav class="side-nav fixed">
        <div id="side-nav-logo-wrapper">
            <img id="side-nav-logo-img" src="../img/logo/logo_white_font_transparent_bg.png"/>
        </div>
        <ul class="side-nav-menu">
            <li><a id="menu-item-dashboard"
                   onClick="configs.goToPage('dashboard');MenuUtils.changeActiveMenu('dashboard')"
                   class="menu-item" href="#!dashboard"><i class="material-icons left side-nav-menu-item-icon">view_module</i><span
                    data-i18n="sidebar.dashboard"></span></a>
            </li>
            <li><a id="menu-item-transactions" class="menu-item"
                   onClick="configs.goToPage('transactions');MenuUtils.changeActiveMenu('transactions')"
                   href="#!transactions?resetFilters=true"><i class="material-icons left side-nav-menu-item-icon">dvr</i><span
                    data-i18n="sidebar.transactions"></span></a>
            </li>
            <li><a id="menu-item-accounts" class="menu-item"
                   onClick="configs.goToPage('accounts');MenuUtils.changeActiveMenu('accounts')"
                   href="#!accounts"><i
                    class="material-icons left side-nav-menu-item-icon">account_balance</i><span
                    data-i18n="sidebar.accounts"></span></a></li>
            <li><a id="menu-item-categories" class="menu-item"
                   onClick="configs.goToPage('categories');MenuUtils.changeActiveMenu('categories')"
                   href="#!categories"><i class="material-icons left side-nav-menu-item-icon">folder_shared</i><span
                    data-i18n="sidebar.categories"></span></a>
            </li>
            <li><a id="menu-item-entities" class="menu-item"
                   onClick="configs.goToPage('entities');MenuUtils.changeActiveMenu('entities')"
                   href="#!entities"><i class="material-icons left side-nav-menu-item-icon">business</i><span
                    data-i18n="sidebar.entities"></span></a>
            </li>
            <li><a id="menu-item-tags" class="menu-item"
                   onClick="configs.goToPage('tags');MenuUtils.changeActiveMenu('tags')"
                   href="#!tags?resetFilters=true"><i class="material-icons left side-nav-menu-item-icon">label</i><span
                    data-i18n="sidebar.tags"></span></a>
            </li>
            <li><a id="menu-item-rules" class="menu-item"
                   onClick="configs.goToPage('rules');MenuUtils.changeActiveMenu('rules')"
                   href="#!rules"><i class="material-icons left side-nav-menu-item-icon">lightbulb_outline</i><span
                    data-i18n="sidebar.rules"></span></a>
            </li>
            <li><a id="menu-item-budgets" class="menu-item"
                   onClick="configs.goToPage('budgets');MenuUtils.changeActiveMenu('budgets')" href="#!budgets?resetFilters=true"><i
                    class="material-icons left side-nav-menu-item-icon">class</i><span
                    data-i18n="sidebar.budgets"></span></a></li>
            <li><a id="menu-item-investments" class="menu-item"
                   onClick="configs.goToPage('investments');MenuUtils.changeActiveMenu('investments')"
                   href="#!investments"><i
                    class="material-icons left side-nav-menu-item-icon">equalizer</i><span
                    data-i18n="sidebar.investments"></span></a></li>
            <li><a id="menu-item-stats" class="menu-item"
                   onClick="configs.goToPage('stats');MenuUtils.changeActiveMenu('stats')" href="#!stats"><i
                    class="material-icons left side-nav-menu-item-icon">folder_shared</i><span
                    data-i18n="sidebar.statistics"></span></a></li>
        </ul>
    </nav>
</header>
<main>
    <!-- Loader -->
    <div class="loader loader-default"></div>
    <div id="main-loading-wrapper" style="display: none;" class="progress main-progress-bar">
        <div class="indeterminate"></div>
    </div>
    <div class="fill-height" id="main-content"></div>
</main>
<footer class="page-footer transparent">
    <div class="footer-copyright transparent">
        <div class="container center-align transparent">
            <span class="black-text">©</span>
            <span class="black-text" id="current-year">2020</span>
            <span class="black-text">António Faneca</span>
        </div>
    </div>
</footer>

<div id="modal-global" class="modal">
    <div class="modal-content"></div>
    <div class="modal-footer"></div>
</div>

<!-- Compiled and minified JavaScript -->
<script src="./js/external/js.cookie.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.2.2/dist/js/materialize.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.8.0/dist/chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-trendline"></script>
<script src="./js/external/monthpicker/monthpicker.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chartjs-chart-sankey"></script>
<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.5.3/dist/js/tabulator.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.min.js"></script>
<script src="js/external/momentjs/moment-with-locales.js"></script>
<script src="js/external/momentjs/moment-timezone.js"></script>
<script type="module" src="https://unpkg.com/emoji-picker-element@1"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
<script src="./js/ensoshared_js_lib/ensoshared.js" type="text/javascript"></script>
<script src="./js/consts.js"></script>
<script src="./js/configs.js" type="module"></script>
<script src="./js/topNav.js" type="module"></script>

<script src="js/utils/localDataManager.js" type="module"></script>
<script src="./js/utils/validationUtils.js" type="module"></script>
<script src="./js/utils/dialogUtils.js" type="module"></script>
<script src="./js/utils/menuUtils.js" type="module"></script>
<script src="./js/utils/pickerUtils.js" type="module"></script>
<script src="./js/utils/tableUtils.js" type="module"></script>
<script src="./js/utils/arrayUtils.js" type="module"></script>
<script src="./js/utils/chartUtils.js" type="module"></script>
<script src="./js/utils/stringUtils.js" type="module"></script>
<script src="./js/utils/loadingManager.js" type="module"></script>
<script src="./js/utils/dateUtils.js" type="module"></script>
<script src="./js/utils/progressbarUtils.js" type="module"></script>
<script src="./js/utils/layoutUtils.js" type="module"></script>

<script src="./js/components/graphEmptyView.js" type="module"></script>
<script src="./js/components/textareaShortcuts.js" type="module"></script>
<script src="./js/components/emojiPicker.js" type="module"></script>

<script src="./js/services/categoryServices.js" type="module"></script>
<script src="./js/services/ruleServices.js" type="module"></script>
<script src="./js/services/budgetServices.js" type="module"></script>
<script src="./js/services/entityServices.js" type="module"></script>
<script src="./js/services/accountServices.js" type="module"></script>
<script src="./js/services/transactionServices.js" type="module"></script>
<script src="./js/services/importTransactionsServices.js" type="module"></script>
<script src="./js/services/statServices.js" type="module"></script>
<script src="./js/services/userServices.js" type="module"></script>
<script src="./js/services/investServices.js" type="module"></script>

<script src="./js/login.js" type="module"></script>
<script src="./js/accounts.js" type="module"></script>
<script src="./js/categories.js" type="module"></script>
<script src="./js/rules.js" type="module"></script>
<script src="./js/budgetDetails.js" type="module"></script>
<script src="./js/importTransactions.js" type="module"></script>
<script src="./js/budgets.js" type="module"></script>
<script src="./js/entities.js" type="module"></script>
<script src="./js/transactions.js" type="module"></script>
<script src="./js/stats.js" type="module"></script>
<script src="./js/dashboard.js" type="module"></script>
<script src="./js/profile.js" type="module"></script>
<script src="./js/investments.js" type="module"></script>

<script type="module">
  import { configs } from './js/configs.js'
  import { LayoutUtils } from './js/utils/layoutUtils.js'
  import { LocalDataManager } from './js/utils/localDataManager.js'
  import { checkPreAuth, checkPreAuthWithInterval, resetSession } from './js/login.js'
  import { TopNav } from './js/topNav.js'
  import { Localization } from './js/utils/localization.js'

  $(window).on('load', function () {
    checkPreAuth()
    checkPreAuthWithInterval()
    TopNav.setupTopNavSummaryAmounts()
  })

  $(document).ready(function () {
    Localization.initLocale()
    configs.loadFirstView('dashboard')
    $('.sidenav').sidenav()
    $('.dropdown-trigger').dropdown()
    LayoutUtils.changeTheme(LayoutUtils.getCurrentThemeName())

    // custom logo for light theme
    if (LocalDataManager.getCurrentTheme() === MYFIN.APP_THEMES.LIGHT) {
      $('#side-nav-logo-img').attr('src', '../img/logo/logo_transparent_bg_v2.png')
    }

    $('#side-nav-logo-img').mouseover(() => onMouseOverLogo(this)).mouseout(() => onMouseOutLogo(this))
  })

  $('#logout-btn').click(() => resetSession())

  function onMouseOverLogo (element) {
    if (LocalDataManager.getCurrentTheme() === MYFIN.APP_THEMES.LIGHT) {
      return
    }

    element.src = '../img/logo/logo_transparent_bg_v2.png'
  }

  function onMouseOutLogo (element) {
    if (LocalDataManager.getCurrentTheme() === MYFIN.APP_THEMES.LIGHT) {
      return
    }
    element.src = '../img/logo/logo_white_font_transparent_bg.png'
  }
</script>
</body>

</html>
